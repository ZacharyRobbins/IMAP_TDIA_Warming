---
title: "oviposition"
author: "Zjrobbin"
date: "8/12/2020"
output: html_document
---

```{r setup, include=FALSE}
F2C<-function(F){
  C=(F-32)*(5/9)
  return(C)
}
  
Taylor_Plot=function(Temp,Rmax,Tmax,Tdelta){
  Rt=Rmax*(exp(-.5*(((Temp-Tmax)/Tdelta)^2)))
  return(Rt)
}
```


This is the original mountain pine beetle model. 


```{r cars,fig.height=10.0}
TC<-seq(0,44,.1)
TB=4.6341
DeltaB=.1
TM=27.7587
DeltaM=3.0759
omega=.3684
psi=.002199





DevR = psi*(exp(omega*(TC - TB)) - (TM - TC)/(TM - TB)*exp(-omega*(TC - TB)/DeltaB) - (TC - TB)/(TM - TB)*exp(omega*(TM - TB) - (TM - TC)/DeltaM))
par(mfrow=c(2,1))
plot(TC,1/(1-exp(-DevR)),ylim=c(10,25),xlim=c(0,40))
abline(v=30)
abline(h=18)
plot(TC,1/(1-exp(-DevR)),ylim=c(0,200),xlim=c(0,40))
abline(v=30)
```

Oviposition expected to take between 
49-10 days with an average of about 23 days
We also assume eggs are laid about 8 days after attack. 

So I assume the rate to lay all eggs is 

56-18 days with a mean around 23 days
10C (50F) is the minimum temperautre of adult activity. 
30C (86F) is the assumed  optimal temperature of adult activity. 
33.9(93F) is the assumed maximum activity temperature. 


The mean development tim for the below curve is 28 days, this seems reasonable as it includes the temperature extremes. 

It sets the boundaries as ~10.3-~33.7*C

Between 15*C and 33*C the mean development rate is 28 days.
The zenith of the curve isapproximately at 30 C the optimal temperature and lasts 18 days (the Shortest time for development)

```{r}
rate<-seq(.1)

Toten<-log(.10)/-DevR



#plot(Toten)
par(mar=c(5,5,3,3))
plot(TC,Toten,ylim=c(0,120),xlim=c(5,36),xlab="Temperature (\u00B0C)",ylab="Days to  oviposit 95% of eggs",cex=1.7,cex.lab=1.7,cex.axis=1.7,
     type="l",lwd=5.0)

min(Toten)
```


```{r cars,fig.height=10.0,fig.height=7.0}

TC<-seq(10.0,33.9,.1)
TB=7.750
DeltaB=10000
TM=34.887
DeltaM=2.0
omega=.0085
psi=34.887



DevR = psi*(exp(omega*(TC - TB)) - (TM - TC)/(TM - TB)*exp(-omega*(TC - TB)/DeltaB) - (TC - TB)/(TM - TB)*exp(omega*(TM - TB) - (TM - TC)/DeltaM))
# par(mfrow=c(2,1))
# plot(TC,1/(1-exp(-DevR)),ylim=c(0,50),xlim=c(0,40),
#      xlab="Temperature",ylab="Days to complete oviposition")
# abline(v=30)
# abline(h=10)

#png("Oviposition.png", units="in", width=10.0, height=7.0, res=300)
par(mar=c(5,5,3,3))
plot(TC,1/(1-exp(-DevR)),ylim=c(0,80),xlim=c(5,36),xlab="Temperature (\u00B0C)",ylab="Days to complete ovipsotion",cex=1.7,cex.lab=1.7,cex.axis=1.7,
     type="l",lwd=5.0)

abline(v=33.9,col="red",lwd=5.0)
abline(v=10.0,col="blue",lwd=5.0)

abline(h=10,lty=3,lwd=5.0)
abline(h=49,lty=3,lwd=5.0)
legend(12,80,legend=c("Rate of Development","Minimum Temp for Adult Activity","Maximum Temp for Adult Activity","Observed Bounds of Ovipostion Time"),pch=c(NA,"|","|",NA,NA),
       lty=c(1,NA,NA,3,3),col=c("black","blue","red"),lwd=c(5,5,5,5),cex=1.5,box.lwd = 0,box.col = "white",bg = "white")
#dev.off()
```


```{r,fig.height=10.0,fig.height=7.0}
plot(TC,(1-exp(-DevR)),xlab="Temperature (\u00B0C)",cex=1.7,cex.lab=1.7,cex.axis=1.7,
     type="l",lwd=5.0)

#abline(v=33.9,col="red",lwd=5.0)
#abline(v=10.0,col="blue",lwd=5.0)
#abline(v=15)
#abline(h=10,lty=3,lwd=5.0)
#abline(h=48,lty=3)
#abline(h=23)
#abline(h=49,lty=3,lwd=5.0)
#legend(12,80,legend=c("Rate of Development","Minimum Temp for Adult Activity","Maximum Temp for Adult Activity","Observed Bounds of Ovipostion Time"),pch=c(NA,"|","|",NA,NA),
#       lty=c(1,NA,NA,3,3),col=c("black","blue","red"),lwd=c(5,5,5,5),cex=1.5,box.lwd = 0,box.col = #"white",bg = "white")
```


```{r}
TC<-seq(10,33.8,.1)
DevR = psi*(exp(omega*(TC - TB)) - (TM - TC)/(TM - TB)*exp(-omega*(TC - TB)/DeltaB) - (TC - TB)/(TM - TB)*exp(omega*(TM - TB) - (TM - TC)/DeltaM))


mean(1/(1-exp(-DevR)))
min(1/(1-exp(-DevR)))
max(1/(1-exp(-DevR)))



```

### New try 




```{r cars,fig.height=10.0,fig.height=7.0}
rate<-seq(.1)

TC<-seq(10.0,33.9,.1)
TB=7.750
DeltaB=10000
TM=35.0
DeltaM=2.0
omega=.0070
psi=.3200


DevR = psi*(exp(omega*(TC - TB)) - (TM - TC)/(TM - TB)*exp(-omega*(TC - TB)/DeltaB) - (TC - TB)/(TM - TB)*exp(omega*(TM - TB) - (TM - TC)/DeltaM))
Toten95<-log(.05)/-DevR
DevR = psi*(exp(omega*(TC - TB)) - (TM - TC)/(TM - TB)*exp(-omega*(TC - TB)/DeltaB) - (TC - TB)/(TM - TB)*exp(omega*(TM - TB) - (TM - TC)/DeltaM))
Toten50<-log(.50)/-DevR
DevR = psi*(exp(omega*(TC - TB)) - (TM - TC)/(TM - TB)*exp(-omega*(TC - TB)/DeltaB) - (TC - TB)/(TM - TB)*exp(omega*(TM - TB) - (TM - TC)/DeltaM))
Toten75<-log(.75)/-DevR


days=log(.75)/-rate


par(mar=c(5,5,3,3))
plot(TC,Toten95,ylim=c(0,60),xlim=c(7,40),xlab="Temperature (\u00B0C)",ylab="Days",cex=1.7,cex.lab=1.7,cex.axis=1.7,
     type="l",lwd=5.0)
lines(TC,Toten50,lwd=5.0,lty=2.0)
lines(TC,Toten75,lwd=5.0,lty=3.0)
#abline(v=33.9,col="red",lwd=5.0)
#abline(v=10.0,col="blue",lwd=5.0)
#abline(h=10,lty=3,lwd=5.0)
#abline(h=49,lty=3,lwd=5.0)
legend(20,50,legend=c("Days to oviposit 95% of eggs","Days to oviposit 75% of eggs","Days to oviposit 50% of eggs"),
       lty=c(1,2,3),col=c("black","black","black"),lwd=c(5,5,5,5),cex=1.7,box.lwd = 0,box.col = "white",bg = "white")


#print(Toten95)
mean(Toten95)
min(Toten95)
max(Toten95)
```

```{r}

```

