print("Tmax1")
(TbP<-opt1$par[2])
print("Tdelta1")
(kappaP<-opt1$par[3])
(delmP<-opt1$par[4])
FakeTemp<-seq(TbP,TmP,1)
Rate_sim<-LoganPlot(FakeTemp,RateP,TbP,TmP,kappaP,delmP)
Larvae<-data.frame(Temp=c(51,60,70,85),
Days=c(296.9,29.69583,20,20))
Larvae$Temp<-F2C(Larvae$Temp)
Data<-Larvae
LoganPlot=function(Temp,Rate,Tb,Tm,kappa,delm){
Rt=Rate*((((Temp-Tb)**2)/(((Temp-Tb)**2)+kappa))-exp(-(Tm-(Temp-Tb))/delm))
return(Rt)
}
#Assuming Tm is 37.8C/
TmP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmP-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,200,6),Temp=as.numeric(DataP[,1]),k=(1/DataP[,2]))
(RateP<-opt1$par[1])
print("Tmax1")
(TbP<-opt1$par[2])
print("Tdelta1")
(kappaP<-opt1$par[3])
(delmP<-opt1$par[4])
FakeTemp<-seq(TbP,TmP,1)
Rate_sim<-LoganPlot(FakeTemp,RateP,TbP,TmP,kappaP,delmP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.3),main="Rate of development of Pupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pupal[,1],1/Pupal[
,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Eggs<-data.frame(Temp=c(53,55,60,70,90),
Days=c(114*8,57*8,40*8,7*8,7*8))
Eggs$Temp<-F2C(Eggs$Temp)
#Tm is 102*F or 38.889
DataE<-Eggs
TmE=38.889
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmE-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.18,10,1000,.5),Temp=as.numeric(DataE[,1]),k=(1/DataE[,2]))
(RateE<-opt1$par[1])
print("Tmax1")
(TbE<-opt1$par[2])
print("Tdelta1")
(kappaE<-opt1$par[3])
(delmE<-opt1$par[4])
FakeTemp<-seq(TbE,TmE,1)
Rate_sim<-LoganPlot(FakeTemp,RateE,TbE,TmE,kappaE,delmE)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.20),main="Rate of development of Eggs",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Eggs[,1],1/Eggs[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Eggs<-data.frame(Temp=c(53,55,60,70,90),
Days=c(114,57,40,7,7))
Eggs$Temp<-F2C(Eggs$Temp)
#Tm is 102*F or 38.889
DataE<-Eggs
TmE=38.889
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmE-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.18,10,1000,.5),Temp=as.numeric(DataE[,1]),k=(1/DataE[,2]))
print("RateE")
(RateE<-opt1$par[1])
print("Tb")
(TbE<-opt1$par[2])
(kappaE<-opt1$par[3])
(delmE<-opt1$par[4])
FakeTemp<-seq(TbE,TmE,1)
Rate_sim<-LoganPlot(FakeTemp,RateE,TbE,TmE,kappaE,delmE)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.20),main="Rate of development of Eggs",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Eggs[,1],1/Eggs[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Eggs<-data.frame(Temp=c(53,55,60,70,90),
Days=c(114*8,57*8,40*8,7*8,7*8))
Eggs$Temp<-F2C(Eggs$Temp)
#Tm is 102*F or 38.889
DataE<-Eggs
TmE=38.889
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmE-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.18,10,1000,.5),Temp=as.numeric(DataE[,1]),k=(1/DataE[,2]))
print("RateE")
(RateE<-opt1$par[1])
print("Tb")
(TbE<-opt1$par[2])
(kappaE<-opt1$par[3])
(delmE<-opt1$par[4])
FakeTemp<-seq(TbE,TmE,1)
Rate_sim<-LoganPlot(FakeTemp,RateE,TbE,TmE,kappaE,delmE)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.20),main="Rate of development of Eggs",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Eggs[,1],1/Eggs[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
plot(FakeTemp,1/Rate_sim,main="Duration of Egg Stage",
xlab="Temp",ylab="Duration",ylim=c(0,100),cex.lab=1.5,cex=2.0,cex.axis=1.5,xlim=c(0,45))
points(DataE[,1],DataE[,2],col="red",pch=16)
legend(4.0,100,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
plot(FakeTemp,1/Rate_sim,main="Duration of Egg Stage",
xlab="Temp",ylab="Duration",ylim=c(0,800),cex.lab=1.5,cex=2.0,cex.axis=1.5,xlim=c(0,45))
points(DataE[,1],DataE[,2],col="red",pch=16)
legend(4.0,100,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Larvae<-data.frame(Temp=c(51,60,70,85),
Days=c(296.9*8,29.69583*8,20*8,20*8))
Larvae$Temp<-F2C(Larvae$Temp)
Data<-Larvae
LoganPlot=function(Temp,Rate,Tb,Tm,kappa,delm){
Rt=Rate*((((Temp-Tb)**2)/(((Temp-Tb)**2)+kappa))-exp(-(Tm-(Temp-Tb))/delm))
return(Rt)
}
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.2,10,1500,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(Tb,Tm,1)
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.2,10,1500,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.1),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.2,10,1500,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.04),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
plot(FakeTemp,1/Rate_sim,main="Duration of Larval Stage",
xlab="Temp",ylab="Duration",ylim=c(0,100),cex.lab=1.5,cex=2.0,cex.axis=1.5,xlim=c(0,40))
points(Data[,1],Data[,2],col="red",pch=16)
legend(2.0,100,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
plot(FakeTemp,1/Rate_sim,main="Duration of Larval Stage",
xlab="Temp",ylab="Duration",ylim=c(0,800),cex.lab=1.5,cex=2.0,cex.axis=1.5,xlim=c(0,40))
points(Data[,1],Data[,2],col="red",pch=16)
legend(2.0,100,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.01,10,1500,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.04),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
(TbL<-opt1$par[2])
Larvae<-data.frame(Temp=c(51,60,70,85),
Days=c(296.9*8,29.69583*8,20*8,20*8))
Larvae$Temp<-F2C(Larvae$Temp)
Data<-Larvae
LoganPlot=function(Temp,Rate,Tb,Tm,kappa,delm){
Rt=Rate*((((Temp-Tb)**2)/(((Temp-Tb)**2)+kappa))-exp(-(Tm-(Temp-Tb))/delm))
return(Rt)
}
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.01,10,1500,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.04),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.01,4,800,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.04),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.01,4,800,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.004),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmL=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.01,4,800,6),Temp=as.numeric(Data[,1]),k=(1/Data[,2]))
(RateL<-opt1$par[1])
print("Tmax1")
(TbL<-opt1$par[2])
print("Tdelta1")
(kappaL<-opt1$par[3])
(delmL<-opt1$par[4])
FakeTemp<-seq(TbL,TmL,1)
Rate_sim<-LoganPlot(FakeTemp,RateL,TbL,TmL,kappaL,delmL)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.04),main="Rate of development of Larvae",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Larvae[,1],1/Larvae[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
plot(FakeTemp,1/Rate_sim,main="Duration of Larval Stage",
xlab="Temp",ylab="Duration",ylim=c(0,800),cex.lab=1.5,cex=2.0,cex.axis=1.5,xlim=c(0,40))
points(Data[,1],Data[,2],col="red",pch=16)
legend(2.0,100,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmPP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,400,1),Temp=as.numeric(DataPP[,1]),k=(1/DataPP[,2]))
Pre_pupal<-data.frame(Temp=c(50*8,55*8,60*8,65*8,74*8),
Days=c(117,7,4,3,2))
Pre_pupal$Temp<-F2C(Pre_pupal$Temp)
DataPP<-Pre_pupal
#Assuming Tm is 35C/
TmPP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,400,1),Temp=as.numeric(DataPP[,1]),k=(1/DataPP[,2]))
(RatePP<-opt1$par[1])
print("Tmax1")
(TbPP<-opt1$par[2])
print("Tdelta1")
(kappaPP<-opt1$par[3])
(delmPP<-opt1$par[4])
FakeTemp<-seq(10,Tm,1)
#Assuming Tm is 35C/
TmPP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,400,1),Temp=as.numeric(DataPP[,1]),k=(1/DataPP[,2]))
(RatePP<-opt1$par[1])
print("Tmax1")
(TbPP<-opt1$par[2])
print("Tdelta1")
(kappaPP<-opt1$par[3])
(delmPP<-opt1$par[4])
FakeTemp<-seq(10,TmPP,1)
Rate_sim<-LoganPlot(FakeTemp,RatePP,TbPP,TmPP,kappaPP,delmPP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.8),main="Rate of development of PrePupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pre_pupal[,1],1/Pre_pupal[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Pre_pupal<-data.frame(Temp=c(50*8,55*8,60*8,65*8,74*8),
Days=c(117,7,4,3,2))
Pre_pupal$Temp<-F2C(Pre_pupal$Temp)
DataPP<-Pre_pupal
#Assuming Tm is 35C/
TmPP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,400,1),Temp=as.numeric(DataPP[,1]),k=(1/DataPP[,2]))
(RatePP<-opt1$par[1])
print("Tmax1")
(TbPP<-opt1$par[2])
print("Tdelta1")
(kappaPP<-opt1$par[3])
(delmPP<-opt1$par[4])
FakeTemp<-seq(10,TmPP,1)
Rate_sim<-LoganPlot(FakeTemp,RatePP,TbPP,TmPP,kappaPP,delmPP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.8),main="Rate of development of PrePupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pre_pupal[,1],1/Pre_pupal[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 35C/
TmPP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,400,1),Temp=as.numeric(DataPP[,1]),k=(1/DataPP[,2]))
(RatePP<-opt1$par[1])
print("Tmax1")
(TbPP<-opt1$par[2])
print("Tdelta1")
(kappaPP<-opt1$par[3])
(delmPP<-opt1$par[4])
FakeTemp<-seq(10,TmPP,1)
Rate_sim<-LoganPlot(FakeTemp,RatePP,TbPP,TmPP,kappaPP,delmPP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.08),main="Rate of development of PrePupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pre_pupal[,1],1/Pre_pupal[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Pre_pupal<-data.frame(Temp=c(50,55,60,65,74),
Days=c(117*8,7*8,4*8,3*8,2*8))
Pre_pupal$Temp<-F2C(Pre_pupal$Temp)
DataPP<-Pre_pupal
#Assuming Tm is 35C/
TmPP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmL-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,400,1),Temp=as.numeric(DataPP[,1]),k=(1/DataPP[,2]))
(RatePP<-opt1$par[1])
print("Tmax1")
(TbPP<-opt1$par[2])
print("Tdelta1")
(kappaPP<-opt1$par[3])
(delmPP<-opt1$par[4])
FakeTemp<-seq(10,TmPP,1)
Rate_sim<-LoganPlot(FakeTemp,RatePP,TbPP,TmPP,kappaPP,delmPP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.08),main="Rate of development of PrePupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pre_pupal[,1],1/Pre_pupal[,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
Pupal<-data.frame(Temp=c(50,55,60,65,74),
Days=c(51*8,24*8,12*8,6*8,6*8))
Pupal$Temp<-F2C(Pupal$Temp)
DataP<-Pupal
#Assuming Tm is 37.8C/
TmP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmP-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,200,6),Temp=as.numeric(DataP[,1]),k=(1/DataP[,2]))
(RateP<-opt1$par[1])
print("Tmax1")
(TbP<-opt1$par[2])
print("Tdelta1")
(kappaP<-opt1$par[3])
(delmP<-opt1$par[4])
FakeTemp<-seq(TbP,TmP,1)
Rate_sim<-LoganPlot(FakeTemp,RateP,TbP,TmP,kappaP,delmP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.3),main="Rate of development of Pupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pupal[,1],1/Pupal[
,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
#Assuming Tm is 37.8C/
TmP=37.8
LoganFunction=function (Temp,par,k){
#Rt= par[1]*exp(-.5*(((Temp-par[2])/par[3])^2))
Rt=par[1]*((((Temp-par[2])**2)/(((Temp-par[2])**2)+par[3]))-exp(-(TmP-(Temp-par[2]))/par[4]))
-sum(dnorm(k,mean=Rt,sd=1,log=TRUE))
}
opt1=optim(fn=LoganFunction,par=c(.5,8,200,6),Temp=as.numeric(DataP[,1]),k=(1/DataP[,2]))
(RateP<-opt1$par[1])
print("Tmax1")
(TbP<-opt1$par[2])
print("Tdelta1")
(kappaP<-opt1$par[3])
(delmP<-opt1$par[4])
FakeTemp<-seq(TbP,TmP,1)
Rate_sim<-LoganPlot(FakeTemp,RateP,TbP,TmP,kappaP,delmP)
#print(cbind(FakeTemp,Rate))
plot(FakeTemp,Rate_sim,xlim=c(0,40),ylim=c(0,.03),main="Rate of development of Pupal",
xlab="Temp",cex.lab=1.5,cex=2.0,cex.axis=2.0)
#lines(FakeTemp,Rate/1-(.25*Rate/1))
#lines(FakeTemp,Rate+(.25*Rate))
points(Pupal[,1],1/Pupal[
,2],col="red",pch=16)
legend(0,.3,legend=c("Modeled","Observed"),pch=c(1,16),col=c('black',"red"))
